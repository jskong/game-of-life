import System.IO.Unsafe
import Control.Concurrent
import Data.String

main = runConwaysGameOfLife

-- Conway's Game of life
runConwaysGameOfLife :: IO ()
runConwaysGameOfLife = do
  putStrLn "Input the game board"
  boardStr <- getLine
  let board = (read boardStr :: [[Bool]])
  putStrLn "Input the number of generations to run"
  generationsStr <- getLine
  let generations = (read generationsStr :: Int)
  gameLoopAction board generations 0
  putStrLn ((show generations) ++ " generations completed")
  return ()

gameLoopAction :: [[Bool]] -> Int -> Int -> IO ()
gameLoopAction matrix numTurns thisGenNum = do
  putStrLn ("Generation: " ++ (show thisGenNum))
  printMatrix matrix
  let nextMatrix = runTurn matrix
  if (numTurns > 0)
    then gameLoopAction nextMatrix (numTurns-1) (thisGenNum+1)
    else return ()

play :: [[Bool]] -> Int -> [[Bool]]
play matrix 0 = matrix
play matrix numTurns = play (runTurnAndPrint matrix) (numTurns-1)

runTurn :: [[Bool]] -> [[Bool]]
runTurn matrix =
  map (\(yIndex, row) ->
    map (\(xIndex, cellStatus) ->
      applyRules cellStatus (countAliveAdjacents matrix xIndex yIndex))
    (zipWithIndex row))
  (zipWithIndex matrix)

runTurnAndPrint :: [[Bool]] -> [[Bool]]
runTurnAndPrint matrix =
  map (\(yIndex, row) ->
    map (\(xIndex, cellStatus) ->
      applyRules cellStatus (countAliveAdjacents matrix xIndex yIndex))
    (zipWithIndex row))
  (zipWithIndex (unsafePerformIO (printMatrix matrix)))

applyRules :: Bool -> Int -> Bool
applyRules cellStatus numAliveAdj =
  if cellStatus
  then (numAliveAdj == 2 || numAliveAdj == 3)
  else (numAliveAdj == 3)

countAliveAdjacents :: [[Bool]] -> Int -> Int -> Int
countAliveAdjacents oMatrix x y = length (filter (isValidAliveCoordOf oMatrix) (adjacentCoordsOf x y))

-- Printing the board
printMatrix :: [[Bool]] -> IO [[Bool]]
printMatrix matrix = do
  putStrLn (toString (mapStatusToCharacters matrix))
  threadDelay 1000000 -- 1 second
  return matrix

mapStatusToCharacters :: [[Bool]] -> [[Char]]
mapStatusToCharacters matrix =
  map (\row ->
    map (\cellStatus ->
      if cellStatus then 'X' else '-')
    row)
  matrix

toString :: [[Char]] -> [Char]
toString xs = foldr (++) "" (map (\str -> str ++ "\n") xs)

-- Helpers
zipWithIndex = zip [0..]
adjacentCoordsOf x y = [(x-1, y-1), (x, y-1), (x+1, y-1), (x-1, y), (x+1, y), (x-1, y+1), (x, y+1), (x+1, y+1)]
isValidAliveCoordOf matrix = (\(x, y) -> (y >= 0  && y < (length matrix) && x >= 0 && x < (length (matrix!!y)) && matrix!!y!!x))

-- Test Matrices
m1 = [[False, True, True],[True, True, True],[False, False, False]]
m2 = [[True,True,True,False,False,False,False,False,True,False],[False,True,True,True,True,False,True,True,False,False],[True,False,False,False,False,False,False,False,True,True],[False,True,True,True,False,False,False,False,False,True],[False,False,False,True,False,False,False,True,True,True],[False,True,False,False,True,True,False,False,True,False],[True,True,True,False,False,True,True,False,True,True],[True,True,True,True,True,True,False,False,True,True],[False,True,True,True,False,True,False,True,True,True],[False,False,False,False,False,False,False,True,False,True],[True,False,False,True,True,False,True,False,False,True]]
m3 = [[True,False,True,False,True,False,True,True,False,False,True,True,True,True,True,False,True,False,False,False,True,False,False,True,True,True,False,True,False,False,False,True,True,True,False,True,True,False,False,False,True,False,True,True,True,True,False,True,True,False,False,False,False,True,False,True,False,False,False,False,False,True,False,False,True,False,True,True,False,True,True,False,False,False,True,False,False,False,False,False,True,True,True,True,False,True,False,False,False,True,True,False,True,False,True,True,True,True,False,True],[False,False,True,False,False,True,False,False,False,True,False,False,False,False,True,False,False,True,False,False,False,True,True,True,True,False,False,True,True,True,False,True,False,True,True,False,True,True,False,True,True,False,True,True,False,True,True,True,False,True,True,False,True,True,True,True,False,True,False,True,True,True,True,True,False,True,False,False,False,True,False,True,True,False,True,True,True,False,True,True,False,False,True,False,False,False,True,False,False,False,False,False,True,False,True,True,False,True,False,True],[False,True,True,False,False,True,True,True,False,True,False,True,True,False,False,False,True,True,True,False,True,False,True,True,True,True,False,True,False,True,False,True,True,True,False,True,True,False,False,True,True,False,True,True,True,True,False,False,True,False,False,True,True,False,True,True,True,False,True,True,False,False,False,False,True,False,True,True,True,False,True,True,True,False,False,False,False,True,False,False,True,True,True,False,True,False,True,False,True,False,False,False,False,True,False,False,False,False,True,False],[False,True,False,False,True,True,False,False,False,True,False,False,True,True,True,True,True,False,False,False,True,False,False,False,True,True,True,False,True,False,False,False,False,False,True,True,False,False,True,False,True,False,False,False,False,False,True,True,True,True,True,True,False,False,False,False,False,True,True,True,False,True,False,True,False,False,True,False,False,True,True,False,True,True,False,True,False,True,True,False,True,False,False,False,False,True,False,True,True,False,True,True,True,False,False,True,False,True,False,True],[True,False,True,False,False,False,False,False,False,True,True,False,True,False,False,False,False,False,False,False,False,False,True,True,True,True,True,True,False,False,True,False,True,False,False,True,False,True,False,False,True,True,False,True,False,False,True,True,False,True,False,True,True,False,False,True,True,False,False,True,True,False,False,False,True,False,True,False,True,True,False,True,True,False,False,True,True,False,False,False,True,True,False,True,False,True,True,True,False,False,False,True,False,False,False,True,False,True,True,False],[False,False,True,False,True,True,False,True,True,True,True,False,True,False,False,True,True,False,True,False,False,True,False,True,True,True,False,True,True,True,False,False,True,True,True,True,False,False,True,False,True,False,True,False,True,True,True,True,True,False,True,True,True,False,False,True,False,False,False,True,False,False,False,True,False,True,True,False,False,True,True,False,False,False,False,True,False,True,False,True,True,True,False,True,True,False,False,True,True,True,False,True,True,True,True,False,True,True,False,True],[False,True,False,False,True,True,True,False,False,True,True,True,False,False,False,False,True,True,True,True,False,False,True,True,True,True,True,False,False,False,False,True,True,True,False,False,True,False,True,True,False,True,False,True,False,False,True,True,False,True,False,False,False,True,False,False,False,True,False,False,False,False,True,True,True,False,True,True,True,True,False,True,True,True,False,True,False,True,False,True,True,False,False,False,True,False,False,True,False,True,False,True,True,True,True,False,False,True,False,True],[False,False,True,False,False,True,True,False,False,False,False,False,True,False,True,True,True,False,True,False,True,False,False,True,False,False,True,False,True,True,False,True,True,True,False,True,False,True,True,True,False,False,True,False,False,True,True,False,False,False,True,True,False,True,False,True,False,True,False,False,True,False,False,True,False,False,True,False,True,False,True,False,True,False,True,True,False,False,False,True,True,True,False,False,False,False,True,True,True,True,False,False,False,True,False,True,True,False,True,True],[False,False,False,True,False,False,False,False,False,False,True,False,False,False,False,False,False,True,True,False,False,True,True,False,False,True,True,False,True,False,True,False,True,True,False,True,True,True,True,True,False,False,False,True,True,True,True,True,False,True,False,False,True,False,True,True,False,True,True,False,False,False,True,False,False,True,True,False,False,True,True,False,False,True,True,False,False,True,False,False,True,False,True,True,True,True,False,False,True,False,False,False,False,True,True,False,False,False,False,True],[False,False,False,True,True,True,True,True,False,False,False,False,False,False,False,True,True,False,False,True,False,True,False,True,False,True,True,True,False,True,True,False,True,True,True,True,True,False,True,True,True,False,False,False,True,True,True,False,False,False,False,False,True,False,False,False,True,True,True,True,True,False,False,False,True,False,True,False,True,True,False,True,True,False,False,True,False,True,False,False,False,False,False,True,False,True,True,False,False,False,True,True,False,False,True,True,False,True,False,False],[False,True,True,False,True,False,True,False,False,False,False,False,False,False,False,False,True,False,False,False,False,True,True,True,False,False,False,True,False,False,False,False,False,False,False,True,True,True,False,False,True,True,False,False,False,True,True,True,True,True,False,True,True,False,True,False,False,True,True,False,False,False,False,False,False,True,True,False,True,False,True,False,True,False,False,True,False,False,False,True,False,True,False,False,True,False,True,False,False,True,False,False,True,True,False,False,True,True,True,False],[True,True,True,False,True,False,False,False,True,False,True,True,True,True,True,True,True,False,True,True,True,True,True,True,True,True,False,True,True,True,False,False,False,True,True,False,False,True,True,True,False,True,False,True,True,True,False,True,False,False,True,True,True,False,False,True,True,True,True,True,False,True,True,True,True,True,True,False,True,True,True,True,False,True,False,True,True,True,True,False,True,False,True,True,False,False,True,True,True,True,False,False,False,True,False,False,True,False,True,True],[True,True,True,False,False,True,True,True,False,True,False,False,True,True,True,True,False,False,False,True,True,True,False,True,False,True,True,True,False,True,False,True,True,True,True,False,False,True,False,True,True,False,False,False,True,True,False,False,False,False,True,True,True,True,True,False,False,True,True,True,True,True,True,False,False,False,True,False,False,True,True,False,True,False,False,True,False,True,False,True,False,True,True,False,True,False,False,True,True,True,False,True,True,True,False,True,False,False,False,True],[False,False,True,True,True,True,False,True,False,False,True,True,True,False,False,True,False,True,False,True,False,False,False,True,True,True,False,True,True,False,True,True,False,True,True,False,False,True,False,False,False,True,True,False,False,True,True,True,True,False,True,True,True,True,False,False,False,True,False,True,False,True,True,False,False,True,True,True,False,False,True,False,True,True,True,True,True,False,False,True,False,False,True,True,True,True,True,False,False,True,False,False,False,False,True,False,False,False,False,False],[False,False,True,True,False,False,False,True,False,False,True,False,True,True,False,True,True,False,True,False,False,True,True,True,True,False,True,False,True,False,True,True,False,True,False,False,False,False,False,True,False,False,False,True,True,False,False,True,True,False,True,True,True,False,True,False,False,True,False,False,False,True,True,False,False,False,False,True,False,True,False,True,False,False,False,True,True,False,False,True,False,True,True,True,False,False,False,False,False,True,True,False,True,False,True,True,True,True,False,False],[True,True,True,False,True,False,True,True,True,True,True,False,True,True,True,True,True,False,False,False,False,True,True,False,True,False,True,False,False,False,False,True,True,False,False,True,False,True,False,True,True,True,True,True,False,False,False,False,False,True,False,False,False,True,False,True,True,False,True,True,True,False,False,True,True,False,True,True,False,True,True,True,True,False,True,False,False,False,False,False,False,True,True,True,True,True,False,True,True,True,True,False,False,False,True,True,True,True,False,True],[True,True,True,True,True,True,True,False,False,True,False,True,True,False,False,True,False,True,False,True,False,True,True,True,True,False,True,True,True,False,False,False,False,True,False,True,True,False,True,False,True,False,False,True,True,True,True,False,False,True,False,True,True,True,True,True,False,True,True,False,False,False,True,False,True,False,True,True,True,False,True,False,True,False,False,True,True,True,True,False,True,False,False,False,True,True,True,True,False,False,True,False,False,False,True,True,False,True,False,False],[False,True,False,False,False,False,True,True,True,True,True,True,False,True,True,True,True,False,True,True,False,True,True,False,False,True,True,False,False,True,False,False,False,False,True,True,False,True,False,False,False,True,False,False,False,True,True,False,True,True,False,True,False,False,False,True,True,False,False,True,False,True,True,False,True,False,False,False,True,False,False,False,False,False,False,False,False,True,False,True,True,True,True,True,False,False,False,False,False,True,True,True,False,False,True,True,True,False,True,True],[True,False,False,False,False,False,True,False,True,True,True,False,True,False,True,True,False,True,True,False,False,True,False,False,False,True,False,False,False,True,False,True,False,True,True,True,True,True,False,False,False,True,True,False,True,False,False,False,True,True,False,False,False,False,True,False,False,True,False,False,False,False,True,True,False,False,False,True,False,False,False,False,True,False,True,True,True,True,True,True,False,True,False,False,False,False,False,False,True,False,True,False,False,False,True,False,False,False,True,False],[False,False,True,True,True,True,True,False,True,True,False,True,False,True,True,False,True,True,False,True,False,True,False,True,True,False,True,True,False,False,False,True,False,True,True,True,True,True,False,False,True,True,False,False,True,True,False,False,True,True,False,True,False,True,False,True,True,True,False,True,True,True,False,False,False,False,True,True,False,False,True,False,True,False,True,False,True,False,False,True,False,True,True,True,False,True,False,True,True,False,False,True,False,True,False,False,False,False,False,True],[True,True,True,False,True,False,True,True,False,False,True,True,True,False,False,False,False,False,False,True,True,False,True,False,False,False,True,False,False,False,True,True,False,True,False,False,False,False,False,True,False,True,True,False,False,False,True,True,False,False,False,True,False,True,False,True,True,False,True,False,True,True,False,True,True,True,True,False,False,False,True,True,False,False,True,False,False,False,True,False,True,False,False,True,True,True,True,True,False,False,True,False,True,True,True,True,True,True,False,False],[True,False,False,False,False,False,True,True,False,True,True,True,False,False,False,True,False,True,False,True,False,False,False,True,True,False,False,True,False,True,True,True,False,False,True,True,True,True,False,False,False,False,False,False,True,False,False,True,False,True,False,False,False,False,True,True,False,True,True,False,True,True,True,True,False,True,True,True,True,False,True,False,False,True,True,True,True,True,True,True,False,True,False,False,True,False,False,True,True,False,True,True,False,False,False,True,False,False,True,True],[False,False,False,False,False,True,True,True,False,False,False,True,True,False,True,False,True,False,True,True,True,True,False,False,False,False,True,True,True,True,True,False,False,True,False,True,True,False,False,False,True,False,True,False,True,False,False,False,True,True,False,False,True,True,True,False,False,False,True,True,False,True,False,False,False,True,True,True,False,True,False,True,False,True,False,True,False,True,False,True,True,True,True,True,True,False,True,True,False,False,False,True,False,False,False,True,False,True,False,False],[False,True,False,False,False,False,False,False,False,True,False,True,True,True,False,False,False,False,True,False,False,True,True,True,False,True,True,False,False,False,False,True,True,True,False,False,False,False,True,True,True,True,False,True,False,True,True,False,False,False,False,True,False,False,True,False,False,False,False,False,True,False,True,False,False,True,True,True,True,False,True,False,True,False,True,True,True,True,True,True,False,False,False,False,False,False,True,True,True,True,True,False,True,True,False,True,False,True,False,True],[True,True,False,True,True,False,False,False,False,False,False,True,True,True,False,False,False,True,False,False,True,False,False,False,False,True,False,False,False,True,True,False,True,True,False,True,False,True,True,False,False,True,True,True,False,True,False,True,False,False,False,False,False,True,False,False,True,False,False,False,True,True,True,True,False,True,True,True,False,True,True,False,True,False,False,True,True,True,True,False,True,False,False,False,False,False,False,False,True,True,True,True,True,False,False,True,True,False,False,False],[False,True,False,False,True,True,True,True,False,False,True,True,False,True,True,False,True,True,False,True,True,False,True,False,False,False,False,True,True,False,True,True,True,False,True,False,True,True,False,False,True,True,False,False,False,True,False,True,True,True,False,True,True,True,True,True,True,False,True,False,False,False,False,True,True,False,True,False,True,False,True,True,False,True,True,False,False,False,False,True,True,False,True,False,False,False,False,False,False,True,True,True,True,True,True,True,True,False,True,True],[True,False,True,False,False,True,False,True,True,False,True,False,True,True,False,False,False,False,False,False,True,True,True,True,True,False,True,True,True,False,True,True,False,True,True,True,False,True,True,False,True,True,False,False,False,True,False,False,True,True,True,True,True,True,True,True,True,True,False,False,True,True,True,False,False,False,True,True,True,False,True,True,True,False,False,True,False,False,True,True,True,False,True,False,True,True,True,False,False,False,False,True,True,False,False,False,True,True,False,False],[True,True,True,False,True,False,False,True,True,True,True,False,True,False,False,False,True,False,False,True,True,True,False,True,False,True,False,False,False,True,True,True,True,True,True,True,False,True,False,True,True,True,True,True,True,True,True,True,True,True,False,True,False,False,False,False,False,True,True,False,True,False,False,True,True,True,True,True,False,True,True,False,False,True,True,True,True,True,True,True,False,False,False,False,True,True,True,False,False,False,False,True,False,True,True,True,True,False,True,False],[True,True,True,False,False,True,False,False,True,False,False,True,False,True,True,False,False,True,False,True,False,True,False,True,True,False,True,True,False,False,False,True,True,False,False,True,False,False,True,True,True,True,True,True,False,True,False,True,False,True,False,True,False,True,False,True,False,False,True,True,False,True,True,False,True,True,True,True,True,False,True,True,False,False,True,True,False,False,True,False,True,False,False,False,True,True,False,False,False,False,False,True,True,True,False,True,True,True,True,True],[True,True,True,True,False,True,True,True,True,True,True,True,True,False,True,False,True,False,False,False,True,True,False,False,False,True,True,True,False,False,True,False,True,False,True,False,False,True,True,False,True,False,True,False,True,True,True,True,True,True,False,False,True,False,False,False,True,True,True,True,True,True,False,False,False,False,False,False,True,True,True,True,True,True,True,True,True,True,False,False,False,True,False,False,False,False,True,True,False,False,True,False,False,False,True,False,False,True,True,False],[True,False,True,False,True,False,False,True,True,True,True,False,True,False,False,False,False,True,True,True,True,True,True,True,False,True,False,False,True,False,False,True,False,False,True,True,False,True,True,True,False,True,False,True,True,True,True,True,False,True,False,False,True,True,True,False,False,True,True,False,False,True,True,True,False,False,False,False,False,True,True,False,True,True,False,True,False,False,True,True,True,False,False,True,True,True,True,True,False,False,False,False,True,False,False,True,True,True,True,True],[True,False,True,False,False,True,True,False,False,True,False,False,False,False,False,True,True,False,True,False,False,True,True,True,False,True,False,True,False,False,True,False,True,True,False,True,True,True,False,True,False,True,True,True,True,True,False,True,False,True,True,False,True,False,False,True,False,True,False,False,True,False,False,False,False,False,False,False,True,False,False,False,False,True,True,False,True,True,True,False,False,False,False,True,True,False,True,False,True,True,True,True,False,True,False,False,False,True,False,True],[False,False,True,True,False,True,False,True,False,True,False,False,False,True,True,True,True,False,True,True,False,False,True,False,True,True,True,True,True,True,True,False,False,False,False,True,False,False,False,True,False,False,True,False,True,False,True,True,True,False,False,False,False,False,True,False,True,False,True,False,False,True,False,False,False,True,True,True,False,True,False,True,True,True,False,True,True,False,True,False,False,False,False,False,True,False,False,False,True,True,True,False,True,False,True,True,True,False,True,False],[False,True,True,True,True,False,False,True,False,True,False,True,False,True,False,True,False,True,True,True,True,False,False,False,False,True,False,True,False,True,True,False,True,True,True,False,True,False,True,False,False,True,True,True,True,False,False,True,True,True,False,False,False,False,False,True,False,False,False,False,False,False,True,False,True,True,False,False,False,False,False,True,False,False,False,True,True,False,True,False,False,True,False,False,False,False,False,False,True,False,True,False,True,False,True,True,False,True,False,True],[True,True,True,False,False,True,True,True,True,True,False,False,True,True,True,True,True,True,False,False,False,True,True,True,True,False,False,False,False,True,False,True,False,False,False,True,True,True,True,True,True,True,False,True,True,True,False,False,True,False,True,False,False,True,True,False,False,False,False,False,False,True,True,False,True,True,False,True,True,True,False,True,False,False,False,False,False,False,False,True,False,False,True,False,True,False,False,False,True,False,True,True,False,True,False,True,False,True,True,False],[True,True,True,False,True,True,True,True,False,True,False,False,True,False,False,False,True,False,True,False,True,True,False,True,True,True,True,True,True,False,True,False,True,False,True,True,True,False,False,True,False,True,False,False,True,False,False,True,True,True,False,True,True,False,True,False,True,False,False,False,False,True,False,True,False,True,True,True,False,False,True,True,False,True,False,True,True,True,False,False,False,False,True,False,True,True,True,True,True,True,False,False,True,True,False,False,False,True,True,True],[True,False,False,True,False,True,True,True,False,True,False,False,True,False,False,True,True,True,False,False,True,True,False,True,True,False,True,True,False,False,False,True,True,True,True,True,False,True,False,True,False,False,True,False,False,False,False,True,False,False,True,False,False,False,True,False,False,True,False,False,False,True,False,True,True,True,True,False,True,True,False,False,False,True,False,True,False,False,False,False,True,True,False,False,False,True,True,True,True,True,False,True,True,False,True,False,True,True,False,False],[True,False,False,False,False,False,True,True,True,False,False,False,True,False,False,True,False,False,False,False,True,True,True,False,False,False,False,False,False,True,False,False,False,True,True,False,False,True,True,True,False,True,True,False,True,False,True,False,False,True,False,True,True,True,False,True,False,True,False,False,True,False,True,True,False,True,True,False,True,False,True,False,True,False,False,False,False,False,False,False,False,False,False,False,True,False,True,False,True,True,False,True,True,True,True,True,False,True,True,False],[True,False,False,False,True,True,True,False,False,False,True,True,False,False,False,True,True,False,True,True,True,True,True,False,False,False,True,False,True,True,False,True,True,True,True,True,False,True,False,True,True,False,True,False,True,False,False,False,False,True,False,True,True,True,False,False,True,False,False,True,True,False,False,False,False,True,False,True,True,True,False,True,False,True,False,False,False,True,False,False,True,False,True,False,True,True,True,True,True,True,True,False,True,False,True,True,True,True,False,True],[False,True,True,True,False,True,False,False,False,False,True,False,False,False,False,False,True,False,True,False,False,False,False,True,False,True,True,False,False,True,False,True,True,False,False,False,True,False,False,False,False,False,True,True,False,True,True,True,False,False,True,True,True,False,False,True,False,False,True,False,True,False,True,False,False,True,False,False,True,False,False,True,True,False,True,False,True,False,True,True,True,False,False,True,False,True,False,False,False,False,True,False,True,True,False,True,False,True,False,True],[True,False,False,True,False,False,False,True,True,True,False,False,False,True,True,False,True,True,False,False,True,False,True,True,False,True,False,False,True,True,True,True,True,False,False,True,False,False,True,False,False,False,False,False,False,True,False,False,True,True,False,True,False,True,True,True,True,True,True,True,True,True,False,True,True,False,True,False,True,False,False,True,True,False,True,False,False,True,False,False,False,True,False,False,False,False,False,True,False,False,True,True,True,False,True,True,True,False,True,True],[True,False,False,False,False,False,True,False,True,False,True,False,False,False,True,True,False,True,False,True,True,False,True,False,False,True,False,True,True,False,False,False,True,False,True,True,True,True,True,True,False,True,True,False,True,False,False,False,True,True,False,False,False,True,True,False,True,False,True,False,False,True,True,True,False,False,True,True,False,True,False,True,False,True,False,False,False,True,True,True,True,False,False,False,False,True,False,False,True,False,True,False,True,True,False,False,False,True,True,True],[False,True,True,True,True,True,False,False,False,True,True,True,False,True,False,False,False,True,False,True,True,True,False,False,True,False,False,True,True,False,False,True,False,False,True,False,False,True,False,True,False,True,False,True,False,False,True,True,False,False,False,True,True,True,True,False,True,False,True,True,True,False,False,False,True,False,True,True,True,True,True,True,True,True,True,True,False,True,True,True,True,True,True,True,True,False,False,False,True,False,True,True,False,False,True,False,False,False,True,False],[False,False,False,True,False,True,False,True,False,True,False,False,True,True,True,False,False,True,True,False,True,False,True,False,False,False,False,False,True,False,True,True,False,True,True,False,True,False,True,False,True,True,False,True,False,False,False,False,True,False,False,False,True,True,False,True,True,False,True,True,False,False,False,True,True,False,False,False,False,True,True,True,False,False,True,True,True,False,True,True,False,True,True,True,False,True,True,False,False,False,False,False,True,False,False,False,False,False,True,True],[True,False,True,True,True,False,True,True,False,False,False,True,False,False,False,False,True,True,True,False,False,False,True,True,True,False,False,False,False,False,True,False,False,True,False,False,False,False,True,True,True,True,False,False,False,False,False,False,True,True,True,False,False,True,True,False,False,False,False,True,False,False,True,False,False,False,False,True,True,False,False,False,False,False,True,True,True,False,True,False,False,True,True,False,False,False,False,False,True,False,True,True,True,True,False,False,True,False,False,False],[False,True,True,False,False,False,False,True,False,True,True,False,True,True,False,True,True,True,True,False,False,False,True,False,False,False,True,False,True,False,True,False,False,False,True,True,False,True,True,False,True,False,False,True,True,False,False,False,True,False,True,False,False,False,True,True,True,True,True,False,False,False,True,False,True,True,True,False,True,False,False,True,True,False,False,False,False,True,True,False,True,False,True,True,False,False,False,False,False,False,True,False,False,True,False,True,True,False,True,False],[True,True,False,False,False,False,False,True,False,True,True,True,False,True,True,False,False,True,False,False,False,False,False,True,True,False,True,False,True,True,True,False,True,True,False,False,False,True,False,False,False,False,True,True,False,False,True,True,True,True,False,True,False,False,False,True,False,False,True,False,True,True,True,True,True,False,False,True,True,True,False,True,True,True,True,False,False,True,False,False,False,True,True,False,True,True,False,True,False,True,False,True,False,True,True,True,False,False,False,True],[False,False,False,True,False,False,True,False,True,False,False,False,True,True,True,True,True,True,False,True,False,True,True,False,True,True,False,True,False,False,False,False,False,True,False,True,True,False,True,True,True,False,True,False,True,True,True,False,False,False,True,False,True,True,False,False,True,True,False,True,False,False,True,False,True,False,False,False,False,False,True,True,True,True,True,True,False,True,True,True,False,True,True,False,True,False,False,True,True,False,False,True,True,True,True,False,True,False,False,False],[True,False,False,True,False,False,True,True,True,True,False,False,True,True,False,True,True,False,True,True,True,True,True,True,False,False,True,False,True,False,True,True,True,True,True,True,False,False,False,True,True,True,False,True,False,False,True,True,False,True,True,True,True,False,False,True,False,True,False,True,True,True,True,True,False,True,False,True,True,True,False,False,True,False,True,False,False,False,True,False,False,False,True,True,False,True,True,True,False,True,False,False,False,False,False,True,False,False,False,False],[True,False,False,False,True,True,True,False,True,False,False,True,False,True,False,False,False,False,False,True,True,False,False,True,True,True,False,False,True,True,False,False,False,True,True,False,True,False,True,False,False,True,False,False,True,False,True,False,True,True,True,False,True,True,False,True,True,True,True,True,True,True,False,True,True,False,False,False,True,True,True,True,False,True,False,False,False,False,False,False,False,True,False,True,False,True,True,False,False,True,False,False,True,True,True,True,True,False,False,True],[False,False,True,True,True,False,True,False,False,False,True,True,True,True,False,False,False,True,True,True,True,True,True,True,False,False,False,False,True,True,True,False,True,False,False,False,False,False,False,True,True,False,False,False,True,False,True,True,False,False,False,True,False,True,True,True,False,True,True,True,False,False,True,True,False,False,False,True,False,True,True,False,True,False,False,False,False,False,True,False,True,False,True,False,False,True,False,True,False,False,True,True,True,False,True,True,True,True,True,False]]
