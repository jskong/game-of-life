import Control.Concurrent

main = playWithInput

-- Conway's Game of life
play :: [[Bool]] -> Int -> IO ()
play board numGenerations = gameLoop board numGenerations 0

playWithInput :: IO ()
playWithInput = do
  board <- getInputFor "game board" (\x -> True)
  numGenerations <- getInputFor "number of generations" (>=0)
  gameLoop board numGenerations 0
  return ()

getInputFor :: Read b => [Char] -> (b -> Bool) -> IO b
getInputFor inputType additionalCondition = do
  let inputFail = putStrLn ("Invalid " ++ inputType ++  ", try again.")
  putStrLn ("Input the " ++ inputType ++ ": ")
  inputStr <- getLine
  case readMaybe inputStr of
    Just input -> if additionalCondition input
      then return input
      else do
        inputFail
        return (getInputFor inputType additionalCondition)()
    Nothing -> do
      inputFail
      return (getInputFor inputType additionalCondition)()

gameLoop :: [[Bool]] -> Int -> Int -> IO ()
gameLoop board numTurns thisGenNum = do
  putStrLn ("Generation: " ++ (show thisGenNum))
  printBoard board
  if allCellsDeadOn board
    then do
      putStrLn ("Completed on generation " ++ (show thisGenNum) ++ "/" ++ (show (thisGenNum + numTurns)) ++ " due to all cells dying.")
      return ()
    else do
      threadDelay 1000000 -- 1 second
      if (numTurns > 0)
        then gameLoop (nextGeneration board) (numTurns-1) (thisGenNum+1)
        else do
          putStrLn ((show thisGenNum) ++ " generations completed.")
          return ()

allCellsDeadOn :: [[Bool]] -> Bool
allCellsDeadOn board = foldl (\allDead row -> (all (==False) row) && allDead) True board

nextGeneration :: [[Bool]] -> [[Bool]]
nextGeneration board =
  map (\(yIndex, row) ->
    map (\(xIndex, cellStatus) ->
      applyRules cellStatus (countAliveAdjacents board xIndex yIndex))
    (zipWithIndex row))
  (zipWithIndex board)

applyRules :: Bool -> Int -> Bool
applyRules cellStatus numAliveAdj =
  if cellStatus
  then (numAliveAdj == 2 || numAliveAdj == 3)
  else (numAliveAdj == 3)

countAliveAdjacents :: [[Bool]] -> Int -> Int -> Int
countAliveAdjacents board x y = length (filter (isValidAliveCoordOf board) (adjacentCoordsOf x y))

isValidAliveCoordOf :: [[Bool]] -> ((Int, Int) -> Bool)
isValidAliveCoordOf board = (\(x, y) -> (y >= 0  && y < (length board) && x >= 0 && x < (length (board!!y)) && board!!y!!x))

adjacentCoordsOf :: Int -> Int -> [(Int, Int)]
adjacentCoordsOf x y = [(x-1, y-1), (x, y-1), (x+1, y-1), (x-1, y), (x+1, y), (x-1, y+1), (x, y+1), (x+1, y+1)]

-- Printing the board
printBoard :: [[Bool]] -> IO ()
printBoard board = do
  putStrLn (toString (mapStatusToCharacters board))
  return ()

mapStatusToCharacters :: [[Bool]] -> [[Char]]
mapStatusToCharacters board =
  map (\row ->
    map (\cellStatus ->
      if cellStatus then 'X' else '-')
    row)
  board

toString :: [[Char]] -> [Char]
toString xs = foldr (++) "" (map (\str -> str ++ "\n") xs)

-- Helpers
zipWithIndex = zip [0..]
readMaybe s = case reads s of
    [(a, "")] -> Just a
    _ -> Nothing

-- Test Matrices
m1 = [[False, True, True],[True, True, True],[False, False, False]]
m2 = [[True,True,True,False,False,False,False,False,True,False],[False,True,True,True,True,False,True,True,False,False],[True,False,False,False,False,False,False,False,True,True],[False,True,True,True,False,False,False,False,False,True],[False,False,False,True,False,False,False,True,True,True],[False,True,False,False,True,True,False,False,True,False],[True,True,True,False,False,True,True,False,True,True],[True,True,True,True,True,True,False,False,True,True],[False,True,True,True,False,True,False,True,True,True],[False,False,False,False,False,False,False,True,False,True],[True,False,False,True,True,False,True,False,False,True]]
m3 = [[True,False,True,False,True,False,True,True,False,False,True,True,True,True,True,False,True,False,False,False,True,False,False,True,True,True,False,True,False,False,False,True,True,True,False,True,True,False,False,False,True,False,True,True,True,True,False,True,True,False,False,False,False,True,False,True,False,False,False,False,False,True,False,False,True,False,True,True,False,True,True,False,False,False,True,False,False,False,False,False,True,True,True,True,False,True,False,False,False,True,True,False,True,False,True,True,True,True,False,True],[False,False,True,False,False,True,False,False,False,True,False,False,False,False,True,False,False,True,False,False,False,True,True,True,True,False,False,True,True,True,False,True,False,True,True,False,True,True,False,True,True,False,True,True,False,True,True,True,False,True,True,False,True,True,True,True,False,True,False,True,True,True,True,True,False,True,False,False,False,True,False,True,True,False,True,True,True,False,True,True,False,False,True,False,False,False,True,False,False,False,False,False,True,False,True,True,False,True,False,True],[False,True,True,False,False,True,True,True,False,True,False,True,True,False,False,False,True,True,True,False,True,False,True,True,True,True,False,True,False,True,False,True,True,True,False,True,True,False,False,True,True,False,True,True,True,True,False,False,True,False,False,True,True,False,True,True,True,False,True,True,False,False,False,False,True,False,True,True,True,False,True,True,True,False,False,False,False,True,False,False,True,True,True,False,True,False,True,False,True,False,False,False,False,True,False,False,False,False,True,False],[False,True,False,False,True,True,False,False,False,True,False,False,True,True,True,True,True,False,False,False,True,False,False,False,True,True,True,False,True,False,False,False,False,False,True,True,False,False,True,False,True,False,False,False,False,False,True,True,True,True,True,True,False,False,False,False,False,True,True,True,False,True,False,True,False,False,True,False,False,True,True,False,True,True,False,True,False,True,True,False,True,False,False,False,False,True,False,True,True,False,True,True,True,False,False,True,False,True,False,True],[True,False,True,False,False,False,False,False,False,True,True,False,True,False,False,False,False,False,False,False,False,False,True,True,True,True,True,True,False,False,True,False,True,False,False,True,False,True,False,False,True,True,False,True,False,False,True,True,False,True,False,True,True,False,False,True,True,False,False,True,True,False,False,False,True,False,True,False,True,True,False,True,True,False,False,True,True,False,False,False,True,True,False,True,False,True,True,True,False,False,False,True,False,False,False,True,False,True,True,False],[False,False,True,False,True,True,False,True,True,True,True,False,True,False,False,True,True,False,True,False,False,True,False,True,True,True,False,True,True,True,False,False,True,True,True,True,False,False,True,False,True,False,True,False,True,True,True,True,True,False,True,True,True,False,False,True,False,False,False,True,False,False,False,True,False,True,True,False,False,True,True,False,False,False,False,True,False,True,False,True,True,True,False,True,True,False,False,True,True,True,False,True,True,True,True,False,True,True,False,True],[False,True,False,False,True,True,True,False,False,True,True,True,False,False,False,False,True,True,True,True,False,False,True,True,True,True,True,False,False,False,False,True,True,True,False,False,True,False,True,True,False,True,False,True,False,False,True,True,False,True,False,False,False,True,False,False,False,True,False,False,False,False,True,True,True,False,True,True,True,True,False,True,True,True,False,True,False,True,False,True,True,False,False,False,True,False,False,True,False,True,False,True,True,True,True,False,False,True,False,True],[False,False,True,False,False,True,True,False,False,False,False,False,True,False,True,True,True,False,True,False,True,False,False,True,False,False,True,False,True,True,False,True,True,True,False,True,False,True,True,True,False,False,True,False,False,True,True,False,False,False,True,True,False,True,False,True,False,True,False,False,True,False,False,True,False,False,True,False,True,False,True,False,True,False,True,True,False,False,False,True,True,True,False,False,False,False,True,True,True,True,False,False,False,True,False,True,True,False,True,True],[False,False,False,True,False,False,False,False,False,False,True,False,False,False,False,False,False,True,True,False,False,True,True,False,False,True,True,False,True,False,True,False,True,True,False,True,True,True,True,True,False,False,False,True,True,True,True,True,False,True,False,False,True,False,True,True,False,True,True,False,False,False,True,False,False,True,True,False,False,True,True,False,False,True,True,False,False,True,False,False,True,False,True,True,True,True,False,False,True,False,False,False,False,True,True,False,False,False,False,True],[False,False,False,True,True,True,True,True,False,False,False,False,False,False,False,True,True,False,False,True,False,True,False,True,False,True,True,True,False,True,True,False,True,True,True,True,True,False,True,True,True,False,False,False,True,True,True,False,False,False,False,False,True,False,False,False,True,True,True,True,True,False,False,False,True,False,True,False,True,True,False,True,True,False,False,True,False,True,False,False,False,False,False,True,False,True,True,False,False,False,True,True,False,False,True,True,False,True,False,False],[False,True,True,False,True,False,True,False,False,False,False,False,False,False,False,False,True,False,False,False,False,True,True,True,False,False,False,True,False,False,False,False,False,False,False,True,True,True,False,False,True,True,False,False,False,True,True,True,True,True,False,True,True,False,True,False,False,True,True,False,False,False,False,False,False,True,True,False,True,False,True,False,True,False,False,True,False,False,False,True,False,True,False,False,True,False,True,False,False,True,False,False,True,True,False,False,True,True,True,False],[True,True,True,False,True,False,False,False,True,False,True,True,True,True,True,True,True,False,True,True,True,True,True,True,True,True,False,True,True,True,False,False,False,True,True,False,False,True,True,True,False,True,False,True,True,True,False,True,False,False,True,True,True,False,False,True,True,True,True,True,False,True,True,True,True,True,True,False,True,True,True,True,False,True,False,True,True,True,True,False,True,False,True,True,False,False,True,True,True,True,False,False,False,True,False,False,True,False,True,True],[True,True,True,False,False,True,True,True,False,True,False,False,True,True,True,True,False,False,False,True,True,True,False,True,False,True,True,True,False,True,False,True,True,True,True,False,False,True,False,True,True,False,False,False,True,True,False,False,False,False,True,True,True,True,True,False,False,True,True,True,True,True,True,False,False,False,True,False,False,True,True,False,True,False,False,True,False,True,False,True,False,True,True,False,True,False,False,True,True,True,False,True,True,True,False,True,False,False,False,True],[False,False,True,True,True,True,False,True,False,False,True,True,True,False,False,True,False,True,False,True,False,False,False,True,True,True,False,True,True,False,True,True,False,True,True,False,False,True,False,False,False,True,True,False,False,True,True,True,True,False,True,True,True,True,False,False,False,True,False,True,False,True,True,False,False,True,True,True,False,False,True,False,True,True,True,True,True,False,False,True,False,False,True,True,True,True,True,False,False,True,False,False,False,False,True,False,False,False,False,False],[False,False,True,True,False,False,False,True,False,False,True,False,True,True,False,True,True,False,True,False,False,True,True,True,True,False,True,False,True,False,True,True,False,True,False,False,False,False,False,True,False,False,False,True,True,False,False,True,True,False,True,True,True,False,True,False,False,True,False,False,False,True,True,False,False,False,False,True,False,True,False,True,False,False,False,True,True,False,False,True,False,True,True,True,False,False,False,False,False,True,True,False,True,False,True,True,True,True,False,False],[True,True,True,False,True,False,True,True,True,True,True,False,True,True,True,True,True,False,False,False,False,True,True,False,True,False,True,False,False,False,False,True,True,False,False,True,False,True,False,True,True,True,True,True,False,False,False,False,False,True,False,False,False,True,False,True,True,False,True,True,True,False,False,True,True,False,True,True,False,True,True,True,True,False,True,False,False,False,False,False,False,True,True,True,True,True,False,True,True,True,True,False,False,False,True,True,True,True,False,True],[True,True,True,True,True,True,True,False,False,True,False,True,True,False,False,True,False,True,False,True,False,True,True,True,True,False,True,True,True,False,False,False,False,True,False,True,True,False,True,False,True,False,False,True,True,True,True,False,False,True,False,True,True,True,True,True,False,True,True,False,False,False,True,False,True,False,True,True,True,False,True,False,True,False,False,True,True,True,True,False,True,False,False,False,True,True,True,True,False,False,True,False,False,False,True,True,False,True,False,False],[False,True,False,False,False,False,True,True,True,True,True,True,False,True,True,True,True,False,True,True,False,True,True,False,False,True,True,False,False,True,False,False,False,False,True,True,False,True,False,False,False,True,False,False,False,True,True,False,True,True,False,True,False,False,False,True,True,False,False,True,False,True,True,False,True,False,False,False,True,False,False,False,False,False,False,False,False,True,False,True,True,True,True,True,False,False,False,False,False,True,True,True,False,False,True,True,True,False,True,True],[True,False,False,False,False,False,True,False,True,True,True,False,True,False,True,True,False,True,True,False,False,True,False,False,False,True,False,False,False,True,False,True,False,True,True,True,True,True,False,False,False,True,True,False,True,False,False,False,True,True,False,False,False,False,True,False,False,True,False,False,False,False,True,True,False,False,False,True,False,False,False,False,True,False,True,True,True,True,True,True,False,True,False,False,False,False,False,False,True,False,True,False,False,False,True,False,False,False,True,False],[False,False,True,True,True,True,True,False,True,True,False,True,False,True,True,False,True,True,False,True,False,True,False,True,True,False,True,True,False,False,False,True,False,True,True,True,True,True,False,False,True,True,False,False,True,True,False,False,True,True,False,True,False,True,False,True,True,True,False,True,True,True,False,False,False,False,True,True,False,False,True,False,True,False,True,False,True,False,False,True,False,True,True,True,False,True,False,True,True,False,False,True,False,True,False,False,False,False,False,True],[True,True,True,False,True,False,True,True,False,False,True,True,True,False,False,False,False,False,False,True,True,False,True,False,False,False,True,False,False,False,True,True,False,True,False,False,False,False,False,True,False,True,True,False,False,False,True,True,False,False,False,True,False,True,False,True,True,False,True,False,True,True,False,True,True,True,True,False,False,False,True,True,False,False,True,False,False,False,True,False,True,False,False,True,True,True,True,True,False,False,True,False,True,True,True,True,True,True,False,False],[True,False,False,False,False,False,True,True,False,True,True,True,False,False,False,True,False,True,False,True,False,False,False,True,True,False,False,True,False,True,True,True,False,False,True,True,True,True,False,False,False,False,False,False,True,False,False,True,False,True,False,False,False,False,True,True,False,True,True,False,True,True,True,True,False,True,True,True,True,False,True,False,False,True,True,True,True,True,True,True,False,True,False,False,True,False,False,True,True,False,True,True,False,False,False,True,False,False,True,True],[False,False,False,False,False,True,True,True,False,False,False,True,True,False,True,False,True,False,True,True,True,True,False,False,False,False,True,True,True,True,True,False,False,True,False,True,True,False,False,False,True,False,True,False,True,False,False,False,True,True,False,False,True,True,True,False,False,False,True,True,False,True,False,False,False,True,True,True,False,True,False,True,False,True,False,True,False,True,False,True,True,True,True,True,True,False,True,True,False,False,False,True,False,False,False,True,False,True,False,False],[False,True,False,False,False,False,False,False,False,True,False,True,True,True,False,False,False,False,True,False,False,True,True,True,False,True,True,False,False,False,False,True,True,True,False,False,False,False,True,True,True,True,False,True,False,True,True,False,False,False,False,True,False,False,True,False,False,False,False,False,True,False,True,False,False,True,True,True,True,False,True,False,True,False,True,True,True,True,True,True,False,False,False,False,False,False,True,True,True,True,True,False,True,True,False,True,False,True,False,True],[True,True,False,True,True,False,False,False,False,False,False,True,True,True,False,False,False,True,False,False,True,False,False,False,False,True,False,False,False,True,True,False,True,True,False,True,False,True,True,False,False,True,True,True,False,True,False,True,False,False,False,False,False,True,False,False,True,False,False,False,True,True,True,True,False,True,True,True,False,True,True,False,True,False,False,True,True,True,True,False,True,False,False,False,False,False,False,False,True,True,True,True,True,False,False,True,True,False,False,False],[False,True,False,False,True,True,True,True,False,False,True,True,False,True,True,False,True,True,False,True,True,False,True,False,False,False,False,True,True,False,True,True,True,False,True,False,True,True,False,False,True,True,False,False,False,True,False,True,True,True,False,True,True,True,True,True,True,False,True,False,False,False,False,True,True,False,True,False,True,False,True,True,False,True,True,False,False,False,False,True,True,False,True,False,False,False,False,False,False,True,True,True,True,True,True,True,True,False,True,True],[True,False,True,False,False,True,False,True,True,False,True,False,True,True,False,False,False,False,False,False,True,True,True,True,True,False,True,True,True,False,True,True,False,True,True,True,False,True,True,False,True,True,False,False,False,True,False,False,True,True,True,True,True,True,True,True,True,True,False,False,True,True,True,False,False,False,True,True,True,False,True,True,True,False,False,True,False,False,True,True,True,False,True,False,True,True,True,False,False,False,False,True,True,False,False,False,True,True,False,False],[True,True,True,False,True,False,False,True,True,True,True,False,True,False,False,False,True,False,False,True,True,True,False,True,False,True,False,False,False,True,True,True,True,True,True,True,False,True,False,True,True,True,True,True,True,True,True,True,True,True,False,True,False,False,False,False,False,True,True,False,True,False,False,True,True,True,True,True,False,True,True,False,False,True,True,True,True,True,True,True,False,False,False,False,True,True,True,False,False,False,False,True,False,True,True,True,True,False,True,False],[True,True,True,False,False,True,False,False,True,False,False,True,False,True,True,False,False,True,False,True,False,True,False,True,True,False,True,True,False,False,False,True,True,False,False,True,False,False,True,True,True,True,True,True,False,True,False,True,False,True,False,True,False,True,False,True,False,False,True,True,False,True,True,False,True,True,True,True,True,False,True,True,False,False,True,True,False,False,True,False,True,False,False,False,True,True,False,False,False,False,False,True,True,True,False,True,True,True,True,True],[True,True,True,True,False,True,True,True,True,True,True,True,True,False,True,False,True,False,False,False,True,True,False,False,False,True,True,True,False,False,True,False,True,False,True,False,False,True,True,False,True,False,True,False,True,True,True,True,True,True,False,False,True,False,False,False,True,True,True,True,True,True,False,False,False,False,False,False,True,True,True,True,True,True,True,True,True,True,False,False,False,True,False,False,False,False,True,True,False,False,True,False,False,False,True,False,False,True,True,False],[True,False,True,False,True,False,False,True,True,True,True,False,True,False,False,False,False,True,True,True,True,True,True,True,False,True,False,False,True,False,False,True,False,False,True,True,False,True,True,True,False,True,False,True,True,True,True,True,False,True,False,False,True,True,True,False,False,True,True,False,False,True,True,True,False,False,False,False,False,True,True,False,True,True,False,True,False,False,True,True,True,False,False,True,True,True,True,True,False,False,False,False,True,False,False,True,True,True,True,True],[True,False,True,False,False,True,True,False,False,True,False,False,False,False,False,True,True,False,True,False,False,True,True,True,False,True,False,True,False,False,True,False,True,True,False,True,True,True,False,True,False,True,True,True,True,True,False,True,False,True,True,False,True,False,False,True,False,True,False,False,True,False,False,False,False,False,False,False,True,False,False,False,False,True,True,False,True,True,True,False,False,False,False,True,True,False,True,False,True,True,True,True,False,True,False,False,False,True,False,True],[False,False,True,True,False,True,False,True,False,True,False,False,False,True,True,True,True,False,True,True,False,False,True,False,True,True,True,True,True,True,True,False,False,False,False,True,False,False,False,True,False,False,True,False,True,False,True,True,True,False,False,False,False,False,True,False,True,False,True,False,False,True,False,False,False,True,True,True,False,True,False,True,True,True,False,True,True,False,True,False,False,False,False,False,True,False,False,False,True,True,True,False,True,False,True,True,True,False,True,False],[False,True,True,True,True,False,False,True,False,True,False,True,False,True,False,True,False,True,True,True,True,False,False,False,False,True,False,True,False,True,True,False,True,True,True,False,True,False,True,False,False,True,True,True,True,False,False,True,True,True,False,False,False,False,False,True,False,False,False,False,False,False,True,False,True,True,False,False,False,False,False,True,False,False,False,True,True,False,True,False,False,True,False,False,False,False,False,False,True,False,True,False,True,False,True,True,False,True,False,True],[True,True,True,False,False,True,True,True,True,True,False,False,True,True,True,True,True,True,False,False,False,True,True,True,True,False,False,False,False,True,False,True,False,False,False,True,True,True,True,True,True,True,False,True,True,True,False,False,True,False,True,False,False,True,True,False,False,False,False,False,False,True,True,False,True,True,False,True,True,True,False,True,False,False,False,False,False,False,False,True,False,False,True,False,True,False,False,False,True,False,True,True,False,True,False,True,False,True,True,False],[True,True,True,False,True,True,True,True,False,True,False,False,True,False,False,False,True,False,True,False,True,True,False,True,True,True,True,True,True,False,True,False,True,False,True,True,True,False,False,True,False,True,False,False,True,False,False,True,True,True,False,True,True,False,True,False,True,False,False,False,False,True,False,True,False,True,True,True,False,False,True,True,False,True,False,True,True,True,False,False,False,False,True,False,True,True,True,True,True,True,False,False,True,True,False,False,False,True,True,True],[True,False,False,True,False,True,True,True,False,True,False,False,True,False,False,True,True,True,False,False,True,True,False,True,True,False,True,True,False,False,False,True,True,True,True,True,False,True,False,True,False,False,True,False,False,False,False,True,False,False,True,False,False,False,True,False,False,True,False,False,False,True,False,True,True,True,True,False,True,True,False,False,False,True,False,True,False,False,False,False,True,True,False,False,False,True,True,True,True,True,False,True,True,False,True,False,True,True,False,False],[True,False,False,False,False,False,True,True,True,False,False,False,True,False,False,True,False,False,False,False,True,True,True,False,False,False,False,False,False,True,False,False,False,True,True,False,False,True,True,True,False,True,True,False,True,False,True,False,False,True,False,True,True,True,False,True,False,True,False,False,True,False,True,True,False,True,True,False,True,False,True,False,True,False,False,False,False,False,False,False,False,False,False,False,True,False,True,False,True,True,False,True,True,True,True,True,False,True,True,False],[True,False,False,False,True,True,True,False,False,False,True,True,False,False,False,True,True,False,True,True,True,True,True,False,False,False,True,False,True,True,False,True,True,True,True,True,False,True,False,True,True,False,True,False,True,False,False,False,False,True,False,True,True,True,False,False,True,False,False,True,True,False,False,False,False,True,False,True,True,True,False,True,False,True,False,False,False,True,False,False,True,False,True,False,True,True,True,True,True,True,True,False,True,False,True,True,True,True,False,True],[False,True,True,True,False,True,False,False,False,False,True,False,False,False,False,False,True,False,True,False,False,False,False,True,False,True,True,False,False,True,False,True,True,False,False,False,True,False,False,False,False,False,True,True,False,True,True,True,False,False,True,True,True,False,False,True,False,False,True,False,True,False,True,False,False,True,False,False,True,False,False,True,True,False,True,False,True,False,True,True,True,False,False,True,False,True,False,False,False,False,True,False,True,True,False,True,False,True,False,True],[True,False,False,True,False,False,False,True,True,True,False,False,False,True,True,False,True,True,False,False,True,False,True,True,False,True,False,False,True,True,True,True,True,False,False,True,False,False,True,False,False,False,False,False,False,True,False,False,True,True,False,True,False,True,True,True,True,True,True,True,True,True,False,True,True,False,True,False,True,False,False,True,True,False,True,False,False,True,False,False,False,True,False,False,False,False,False,True,False,False,True,True,True,False,True,True,True,False,True,True],[True,False,False,False,False,False,True,False,True,False,True,False,False,False,True,True,False,True,False,True,True,False,True,False,False,True,False,True,True,False,False,False,True,False,True,True,True,True,True,True,False,True,True,False,True,False,False,False,True,True,False,False,False,True,True,False,True,False,True,False,False,True,True,True,False,False,True,True,False,True,False,True,False,True,False,False,False,True,True,True,True,False,False,False,False,True,False,False,True,False,True,False,True,True,False,False,False,True,True,True],[False,True,True,True,True,True,False,False,False,True,True,True,False,True,False,False,False,True,False,True,True,True,False,False,True,False,False,True,True,False,False,True,False,False,True,False,False,True,False,True,False,True,False,True,False,False,True,True,False,False,False,True,True,True,True,False,True,False,True,True,True,False,False,False,True,False,True,True,True,True,True,True,True,True,True,True,False,True,True,True,True,True,True,True,True,False,False,False,True,False,True,True,False,False,True,False,False,False,True,False],[False,False,False,True,False,True,False,True,False,True,False,False,True,True,True,False,False,True,True,False,True,False,True,False,False,False,False,False,True,False,True,True,False,True,True,False,True,False,True,False,True,True,False,True,False,False,False,False,True,False,False,False,True,True,False,True,True,False,True,True,False,False,False,True,True,False,False,False,False,True,True,True,False,False,True,True,True,False,True,True,False,True,True,True,False,True,True,False,False,False,False,False,True,False,False,False,False,False,True,True],[True,False,True,True,True,False,True,True,False,False,False,True,False,False,False,False,True,True,True,False,False,False,True,True,True,False,False,False,False,False,True,False,False,True,False,False,False,False,True,True,True,True,False,False,False,False,False,False,True,True,True,False,False,True,True,False,False,False,False,True,False,False,True,False,False,False,False,True,True,False,False,False,False,False,True,True,True,False,True,False,False,True,True,False,False,False,False,False,True,False,True,True,True,True,False,False,True,False,False,False],[False,True,True,False,False,False,False,True,False,True,True,False,True,True,False,True,True,True,True,False,False,False,True,False,False,False,True,False,True,False,True,False,False,False,True,True,False,True,True,False,True,False,False,True,True,False,False,False,True,False,True,False,False,False,True,True,True,True,True,False,False,False,True,False,True,True,True,False,True,False,False,True,True,False,False,False,False,True,True,False,True,False,True,True,False,False,False,False,False,False,True,False,False,True,False,True,True,False,True,False],[True,True,False,False,False,False,False,True,False,True,True,True,False,True,True,False,False,True,False,False,False,False,False,True,True,False,True,False,True,True,True,False,True,True,False,False,False,True,False,False,False,False,True,True,False,False,True,True,True,True,False,True,False,False,False,True,False,False,True,False,True,True,True,True,True,False,False,True,True,True,False,True,True,True,True,False,False,True,False,False,False,True,True,False,True,True,False,True,False,True,False,True,False,True,True,True,False,False,False,True],[False,False,False,True,False,False,True,False,True,False,False,False,True,True,True,True,True,True,False,True,False,True,True,False,True,True,False,True,False,False,False,False,False,True,False,True,True,False,True,True,True,False,True,False,True,True,True,False,False,False,True,False,True,True,False,False,True,True,False,True,False,False,True,False,True,False,False,False,False,False,True,True,True,True,True,True,False,True,True,True,False,True,True,False,True,False,False,True,True,False,False,True,True,True,True,False,True,False,False,False],[True,False,False,True,False,False,True,True,True,True,False,False,True,True,False,True,True,False,True,True,True,True,True,True,False,False,True,False,True,False,True,True,True,True,True,True,False,False,False,True,True,True,False,True,False,False,True,True,False,True,True,True,True,False,False,True,False,True,False,True,True,True,True,True,False,True,False,True,True,True,False,False,True,False,True,False,False,False,True,False,False,False,True,True,False,True,True,True,False,True,False,False,False,False,False,True,False,False,False,False],[True,False,False,False,True,True,True,False,True,False,False,True,False,True,False,False,False,False,False,True,True,False,False,True,True,True,False,False,True,True,False,False,False,True,True,False,True,False,True,False,False,True,False,False,True,False,True,False,True,True,True,False,True,True,False,True,True,True,True,True,True,True,False,True,True,False,False,False,True,True,True,True,False,True,False,False,False,False,False,False,False,True,False,True,False,True,True,False,False,True,False,False,True,True,True,True,True,False,False,True],[False,False,True,True,True,False,True,False,False,False,True,True,True,True,False,False,False,True,True,True,True,True,True,True,False,False,False,False,True,True,True,False,True,False,False,False,False,False,False,True,True,False,False,False,True,False,True,True,False,False,False,True,False,True,True,True,False,True,True,True,False,False,True,True,False,False,False,True,False,True,True,False,True,False,False,False,False,False,True,False,True,False,True,False,False,True,False,True,False,False,True,True,True,False,True,True,True,True,True,False]]
